---
title: "Rethinking_Stats_Chapter_14.Rmd"
author: "Alex Bayers"
date: "26/03/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Easy
### Problem 1
Our base model is as follows:

$$
\\T_i \sim  Poisson(\mu_i)
\\log \> \mu_i = \alpha \> + \> \beta * log \> P_i
\\\alpha \sim Normal(0, 10)
\\\beta \sim Nornal(0, 1)
$$
The model with measurement error is as follows:

$$
\\T_i \sim  Posson(\mu_i)
\\log \> \mu_i = \alpha \> + \> \beta * log \> P_{EST, i}
\\P_{OBS, i} \sim Normal(P_{EST, i}, P_{SE,i})
\\\alpha \sim Normal(0, 10)
\\\beta \sim Nornal(0, 1)
$$

### Problem 2

Our new model for unobserved populations follows below, allowing for unobserved populations.

$$
\\T_i \sim  Poisson(\mu_i)
\\log \> \mu_i = \alpha \> + \> \beta * log \> P_i
\\P_i \sim Normal(\nu, \sigma)
\\\alpha \sim Normal(0, 10)
\\\beta \sim Nornal(0, 1),
\\nu \sim Normal(34000, 30000)
\\\sigma \sim Cauchy(10000)
$$

## Medium
### Problem 1
In the mathematical model, when we have data missing, we are assuming a given distribution for the missing data.  In this case, we assume a mean for the missing data $$ \nu $$, and a standard deviation $$ \sigma_n $$.

### Problem 2
```{r}
## R code 6.21
data(milk)
d <-milk
d$neocortex <- d$neocortex.perc / 100
dim(d)

## R code 6.22
a.start <- mean(d$kcal.per.g)
sigma.start <- log(sd(d$kcal.per.g))
m6.11 <- map(
    alist(
        kcal.per.g ~ dnorm( a , exp(log.sigma) )
    ) ,
    data=d , start=list(a=a.start,log.sigma=sigma.start) )
m6.12 <- map(
    alist(
        kcal.per.g ~ dnorm( mu , exp(log.sigma) ) ,
        mu <- a + bn*neocortex
    ) ,
    data=d , start=list(a=a.start,bn=0,log.sigma=sigma.start) )
m6.13 <- map(
    alist(
        kcal.per.g ~ dnorm( mu , exp(log.sigma) ) ,
        mu <- a + bm*log(mass)
    ) ,
    data=d , start=list(a=a.start,bm=0,log.sigma=sigma.start) )
m6.14 <- map(
    alist(
        kcal.per.g ~ dnorm( mu , exp(log.sigma) ) ,
        mu <- a + bn*neocortex + bm*log(mass)
    ) ,
    data=d , start=list(a=a.start,bn=0,bm=0,log.sigma=sigma.start) )
```
